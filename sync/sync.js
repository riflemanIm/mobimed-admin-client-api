"use strict";

var _lodash = require("lodash");

var _ru = _interopRequireDefault(require("./translations/ru.json"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

const LANG = "ru";
const PROJECT_NAME = "test";
const url = `http://localhost:8000/api/translations/download/${LANG}/${PROJECT_NAME}`;
const urlUpload = "http://localhost:8000/api/translations/import-file";

const requestPromise = require("request-promise");

const request = require("request");

const fs = require("fs");
/**  GET REMOTE JSON  */

requestPromise({
  url,
  method: "GET",
  json: true,
})
  .then((remoteJson) => {
    /**  MERGE LOCAL AND REMOTE  */
    const mergedJson = (0, _lodash.merge)(remoteJson, _ru.default);
    /**  SAVE TO LOCAL  */

    return new Promise(function (resolve, reject) {
      fs.writeFile(
        `${__dirname}/translations/ru.json`,
        JSON.stringify(mergedJson, null, 2),
        (err) => {
          if (err) reject(err);
          else resolve(true);
        }
      );
    });
  })
  .then((saved) => {
    if (saved) {
      setTimeout(() => {
        const req = request.put(urlUpload, function (err, resp, body) {
          if (err) {
            console.error("Error!", err.message);
          } else {
            console.log("Result: " + body);
          }
        });
        const form = req.form();
        form.append(
          "filedata",
          fs.createReadStream(`${__dirname}/translations/ru.json`)
        );
        form.append("filename", `${LANG}.json`);
        form.append("account_id", "1");
        form.append("pname", "test");
        form.append("deleteOldKeys", "false");
        form.append("doBackup", "true");
      }, 2000);
    }
  })
  .catch((err) => console.error(err.message));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zeW5jLmpzIl0sIm5hbWVzIjpbIkxBTkciLCJQUk9KRUNUX05BTUUiLCJ1cmwiLCJ1cmxVcGxvYWQiLCJyZXF1ZXN0UHJvbWlzZSIsInJlcXVpcmUiLCJyZXF1ZXN0IiwiZnMiLCJtZXRob2QiLCJqc29uIiwidGhlbiIsInJlbW90ZUpzb24iLCJtZXJnZWRKc29uIiwibG9jYWxKc29uIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ3cml0ZUZpbGUiLCJfX2Rpcm5hbWUiLCJKU09OIiwic3RyaW5naWZ5IiwiZXJyIiwic2F2ZWQiLCJzZXRUaW1lb3V0IiwicmVxIiwicHV0IiwicmVzcCIsImJvZHkiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXNzYWdlIiwibG9nIiwiZm9ybSIsImFwcGVuZCIsImNyZWF0ZVJlYWRTdHJlYW0iLCJjYXRjaCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7OztBQUNBLE1BQU1BLElBQUksR0FBRyxJQUFiO0FBQ0EsTUFBTUMsWUFBWSxHQUFHLE1BQXJCO0FBQ0EsTUFBTUMsR0FBRyxHQUFJLG1EQUFrREYsSUFBSyxJQUFHQyxZQUFhLEVBQXBGO0FBQ0EsTUFBTUUsU0FBUyxHQUFHLG9EQUFsQjs7QUFFQSxNQUFNQyxjQUFjLEdBQUdDLE9BQU8sQ0FBQyxpQkFBRCxDQUE5Qjs7QUFDQSxNQUFNQyxPQUFPLEdBQUdELE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUVBLE1BQU1FLEVBQUUsR0FBR0YsT0FBTyxDQUFDLElBQUQsQ0FBbEI7QUFFQTs7O0FBQ0FELGNBQWMsQ0FBQztBQUNiRixFQUFBQSxHQURhO0FBRWJNLEVBQUFBLE1BQU0sRUFBRSxLQUZLO0FBR2JDLEVBQUFBLElBQUksRUFBRTtBQUhPLENBQUQsQ0FBZCxDQUtHQyxJQUxILENBS1NDLFVBQUQsSUFBZ0I7QUFDcEI7QUFDQSxRQUFNQyxVQUFVLEdBQUcsbUJBQU1ELFVBQU4sRUFBa0JFLFdBQWxCLENBQW5CO0FBRUE7O0FBRUEsU0FBTyxJQUFJQyxPQUFKLENBQVksVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDNUNULElBQUFBLEVBQUUsQ0FBQ1UsU0FBSCxDQUNHLEdBQUVDLFNBQVUsdUJBRGYsRUFFRUMsSUFBSSxDQUFDQyxTQUFMLENBQWVSLFVBQWYsRUFBMkIsSUFBM0IsRUFBaUMsQ0FBakMsQ0FGRixFQUdHUyxHQUFELElBQVM7QUFDUCxVQUFJQSxHQUFKLEVBQVNMLE1BQU0sQ0FBQ0ssR0FBRCxDQUFOLENBQVQsS0FDS04sT0FBTyxDQUFDLElBQUQsQ0FBUDtBQUNOLEtBTkg7QUFRRCxHQVRNLENBQVA7QUFVRCxDQXJCSCxFQXNCR0wsSUF0QkgsQ0FzQlNZLEtBQUQsSUFBVztBQUNmLE1BQUlBLEtBQUosRUFBVztBQUNUQyxJQUFBQSxVQUFVLENBQUMsTUFBTTtBQUNmLFlBQU1DLEdBQUcsR0FBR2xCLE9BQU8sQ0FBQ21CLEdBQVIsQ0FBWXRCLFNBQVosRUFBdUIsVUFBVWtCLEdBQVYsRUFBZUssSUFBZixFQUFxQkMsSUFBckIsRUFBMkI7QUFDNUQsWUFBSU4sR0FBSixFQUFTO0FBQ1BPLFVBQUFBLE9BQU8sQ0FBQ0MsS0FBUixDQUFjLFFBQWQsRUFBd0JSLEdBQUcsQ0FBQ1MsT0FBNUI7QUFDRCxTQUZELE1BRU87QUFDTEYsVUFBQUEsT0FBTyxDQUFDRyxHQUFSLENBQVksYUFBYUosSUFBekI7QUFDRDtBQUNGLE9BTlcsQ0FBWjtBQU9BLFlBQU1LLElBQUksR0FBR1IsR0FBRyxDQUFDUSxJQUFKLEVBQWI7QUFDQUEsTUFBQUEsSUFBSSxDQUFDQyxNQUFMLENBQ0UsVUFERixFQUVFMUIsRUFBRSxDQUFDMkIsZ0JBQUgsQ0FBcUIsR0FBRWhCLFNBQVUsdUJBQWpDLENBRkY7QUFJQWMsTUFBQUEsSUFBSSxDQUFDQyxNQUFMLENBQVksVUFBWixFQUF5QixHQUFFakMsSUFBSyxPQUFoQztBQUNBZ0MsTUFBQUEsSUFBSSxDQUFDQyxNQUFMLENBQVksWUFBWixFQUEwQixHQUExQjtBQUNBRCxNQUFBQSxJQUFJLENBQUNDLE1BQUwsQ0FBWSxPQUFaLEVBQXFCLE1BQXJCO0FBQ0FELE1BQUFBLElBQUksQ0FBQ0MsTUFBTCxDQUFZLGVBQVosRUFBNkIsT0FBN0I7QUFDQUQsTUFBQUEsSUFBSSxDQUFDQyxNQUFMLENBQVksVUFBWixFQUF3QixNQUF4QjtBQUNELEtBbEJTLEVBa0JQLElBbEJPLENBQVY7QUFtQkQ7QUFDRixDQTVDSCxFQTZDR0UsS0E3Q0gsQ0E2Q1VkLEdBQUQsSUFBU08sT0FBTyxDQUFDQyxLQUFSLENBQWNSLEdBQUcsQ0FBQ1MsT0FBbEIsQ0E3Q2xCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgbWVyZ2UgfSBmcm9tIFwibG9kYXNoXCI7XG5pbXBvcnQgbG9jYWxKc29uIGZyb20gXCIuL3RyYW5zbGF0aW9ucy9ydS5qc29uXCI7XG5jb25zdCBMQU5HID0gXCJydVwiO1xuY29uc3QgUFJPSkVDVF9OQU1FID0gXCJ0ZXN0XCI7XG5jb25zdCB1cmwgPSBgaHR0cDovL2xvY2FsaG9zdDo4MDAwL2FwaS90cmFuc2xhdGlvbnMvZG93bmxvYWQvJHtMQU5HfS8ke1BST0pFQ1RfTkFNRX1gO1xuY29uc3QgdXJsVXBsb2FkID0gXCJodHRwOi8vbG9jYWxob3N0OjgwMDAvYXBpL3RyYW5zbGF0aW9ucy9pbXBvcnQtZmlsZVwiO1xuXG5jb25zdCByZXF1ZXN0UHJvbWlzZSA9IHJlcXVpcmUoXCJyZXF1ZXN0LXByb21pc2VcIik7XG5jb25zdCByZXF1ZXN0ID0gcmVxdWlyZShcInJlcXVlc3RcIik7XG5cbmNvbnN0IGZzID0gcmVxdWlyZShcImZzXCIpO1xuXG4vKiogIEdFVCBSRU1PVEUgSlNPTiAgKi9cbnJlcXVlc3RQcm9taXNlKHtcbiAgdXJsLFxuICBtZXRob2Q6IFwiR0VUXCIsXG4gIGpzb246IHRydWUsXG59KVxuICAudGhlbigocmVtb3RlSnNvbikgPT4ge1xuICAgIC8qKiAgTUVSR0UgTE9DQUwgQU5EIFJFTU9URSAgKi9cbiAgICBjb25zdCBtZXJnZWRKc29uID0gbWVyZ2UocmVtb3RlSnNvbiwgbG9jYWxKc29uKTtcblxuICAgIC8qKiAgU0FWRSBUTyBMT0NBTCAgKi9cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBmcy53cml0ZUZpbGUoXG4gICAgICAgIGAke19fZGlybmFtZX0vdHJhbnNsYXRpb25zL3J1Lmpzb25gLFxuICAgICAgICBKU09OLnN0cmluZ2lmeShtZXJnZWRKc29uLCBudWxsLCAyKSxcbiAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHJlamVjdChlcnIpO1xuICAgICAgICAgIGVsc2UgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9KTtcbiAgfSlcbiAgLnRoZW4oKHNhdmVkKSA9PiB7XG4gICAgaWYgKHNhdmVkKSB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3QgcmVxID0gcmVxdWVzdC5wdXQodXJsVXBsb2FkLCBmdW5jdGlvbiAoZXJyLCByZXNwLCBib2R5KSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIVwiLCBlcnIubWVzc2FnZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVzdWx0OiBcIiArIGJvZHkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGZvcm0gPSByZXEuZm9ybSgpO1xuICAgICAgICBmb3JtLmFwcGVuZChcbiAgICAgICAgICBcImZpbGVkYXRhXCIsXG4gICAgICAgICAgZnMuY3JlYXRlUmVhZFN0cmVhbShgJHtfX2Rpcm5hbWV9L3RyYW5zbGF0aW9ucy9ydS5qc29uYClcbiAgICAgICAgKTtcbiAgICAgICAgZm9ybS5hcHBlbmQoXCJmaWxlbmFtZVwiLCBgJHtMQU5HfS5qc29uYCk7XG4gICAgICAgIGZvcm0uYXBwZW5kKFwiYWNjb3VudF9pZFwiLCBcIjFcIik7XG4gICAgICAgIGZvcm0uYXBwZW5kKFwicG5hbWVcIiwgXCJ0ZXN0XCIpO1xuICAgICAgICBmb3JtLmFwcGVuZChcImRlbGV0ZU9sZEtleXNcIiwgXCJmYWxzZVwiKTtcbiAgICAgICAgZm9ybS5hcHBlbmQoXCJkb0JhY2t1cFwiLCBcInRydWVcIik7XG4gICAgICB9LCAyMDAwKTtcbiAgICB9XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVyci5tZXNzYWdlKSk7XG4iXX0=
